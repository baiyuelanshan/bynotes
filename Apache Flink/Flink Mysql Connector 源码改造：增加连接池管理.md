## 问题描述

MySQL服务端设置了连接过期时间（5分钟），在（深夜）流量低峰时MySQL连接会断开，导致Flink查询MySQL维表数据时因为连接已经失效而异常退出。验证业务时使用了少量的流量，大概占1%。

Flink版本: 1.10

#### 解决

实现了一个简单的连接池管理的基本功能：
- 检查连接是否有效(根据过期时间判定)
- 回收无效的连接
- 建立连接

## 修改的类

`JDBCLookupFunction`

利用原始代码中的重试机制，
当第一次查询捕获SQLException异常时，检查连接是否有效，
如果无效：1. 回收无效的连接 2. 创建连接和statement


`官方在Flink 1.11解决了这个bug`
